---
import SEO from "@/components/seo.astro";

interface Props {
    title?: string;
    description?: string;
    image?: string;
    type?: string;
}

const { title = "Portfolio", description = "Personal portfolio showcasing my work, skills, and experience.", image, type } = Astro.props;
---

<script is:inline>
    const getThemePreference = () => {
        if (typeof localStorage !== "undefined") {
            const storedTheme = localStorage.getItem("theme");
            if (storedTheme) {
                return storedTheme;
            }
        }
        return window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
    };

    // Set the theme only once at initial load
    const theme = getThemePreference();
    document.documentElement.classList.toggle("dark", theme === "dark");

    if (typeof localStorage !== "undefined") {
        // Store initial theme
        localStorage.setItem("theme", theme);

        // Observe theme changes
        const observer = new MutationObserver(() => {
            const isDark = document.documentElement.classList.contains("dark");
            localStorage.setItem("theme", isDark ? "dark" : "light");
        });
        observer.observe(document.documentElement, { attributes: true, attributeFilter: ["class"] });
    }
</script>

<html lang="en">
    <head>
        <SEO title={title} description={description} image={image} type={type} />
    </head>
    <body class="min-h-screen bg-background text-foreground antialiased">
        <a
            href="#main-content"
            class="sr-only focus:not-sr-only focus:fixed focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-background focus:text-foreground focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"
        >
            Skip to main content
        </a>
        <div id="main-content" class="relative">
            <slot />
        </div>
    </body>
</html>

<style is:global>
    :root {
        --background: 0 0% 100%;
        --foreground: 240 10% 3.9%;
    }

    .dark {
        --background: 240 10% 3.9%;
        --foreground: 0 0% 98%;
    }

    html {
        scroll-behavior: smooth;
    }

    body {
        margin: 0;
        width: 100%;
        height: 100%;
    }

    /* Improve focus styles */
    :focus-visible {
        outline: 2px solid hsl(var(--foreground));
        outline-offset: 2px;
    }

    /* Hide scrollbar for Chrome, Safari and Opera */
    .no-scrollbar::-webkit-scrollbar {
        display: none;
    }

    /* Hide scrollbar for IE, Edge and Firefox */
    .no-scrollbar {
        -ms-overflow-style: none; /* IE and Edge */
        scrollbar-width: none; /* Firefox */
    }
</style>
